# Fantasy World Builder - Desktop Application

## Про застосунок

Fantasy World Builder тепер доступний як повноцінний десктопний застосунок завдяки Electron! 

### Ключові переваги десктопної версії:

- **Офлайн робота**: Всі дані зберігаються локально в SQLite базі даних
- **Швидкість**: Немає затримок мережі, миттєвий доступ до даних
- **Безпека**: Ваші світи зберігаються тільки на вашому комп'ютері
- **Нативна інтеграція**: Меню, діалоги збереження/відкриття файлів, горячі клавіші
- **Автоматичне збереження**: Стан вікна та налаштування зберігаються автоматично

## Встановлення та запуск

### Режим розробки

```bash
# Встановити залежності
npm install

# Запустити в режимі розробки (веб + Electron)
npm run electron:dev

# Або запустити тільки Electron (якщо веб сервер вже працює)
npm run electron
```

### Збірка для продакшену

```bash
# Зібрати застосунок для поточної платформи
npm run electron:build

# Створити тільки папку з файлами (без інсталятора)
npm run electron:pack

# Зібрати для всіх платформ
npm run dist
```

## Архітектура

### Головні компоненти:

1. **electron/main.js** - Головний процес Electron
2. **electron/preload.js** - Безпечний міст між головним та рендер процесами
3. **electron-db/sqlite-storage.js** - SQLite база даних для десктопної версії
4. **server/electron-server.js** - Express сервер для десктопної версії
5. **client/src/lib/electron-helpers.ts** - Допоміжні функції для роботи з Electron API

### База даних:

- **Веб версія**: PostgreSQL (Neon Database)
- **Десктопна версія**: SQLite (локальний файл)
- Автоматична міграція схеми
- Повна сумісність API між версіями

### Файлова система:

- Дані зберігаються в `userData/fantasy-world-builder/`
- Автоматичні бекапи налаштувань
- Нативні діалоги збереження/відкриття файлів

## Функції десктопної версії

### Меню застосунку:

- **Файл**: Новий світ, Відкрити, Зберегти, Експорт
- **Редагування**: Стандартні операції (копіювати, вставити, тощо)
- **Вигляд**: Масштабування, повноекранний режим, інструменти розробника
- **Допомога**: Документація та посилання

### Гарячі клавіші:

- `Ctrl/Cmd + N` - Новий світ
- `Ctrl/Cmd + O` - Відкрити світ
- `Ctrl/Cmd + S` - Зберегти
- `Ctrl/Cmd + E` - Експорт світу
- `Ctrl/Cmd + ,` - Налаштування
- `F11` - Повноекранний режим

### Експорт/Імпорт:

- Нативні діалоги для вибору файлів
- Повний експорт світу в JSON
- Імпорт з резервних копій
- Міграція між пристроями

## Налаштування збірки

Конфігурація в `package.json`:

```json
{
  "build": {
    "appId": "com.fantasy-world-builder.app",
    "productName": "Fantasy World Builder",
    "directories": {
      "output": "dist-electron"
    },
    "files": [
      "dist/**/*",
      "electron/**/*",
      "electron-db/**/*",
      "node_modules/**/*"
    ]
  }
}
```

## Платформи

Підтримуються платформи:

- **Windows**: NSIS інсталятор (.exe)
- **macOS**: DMG пакет (.dmg)
- **Linux**: AppImage (.AppImage)

## Troubleshooting

### Проблеми з SQLite:

```bash
# Перебудувати better-sqlite3 для вашої платформи
npm rebuild better-sqlite3
```

### Помилки Electron:

```bash
# Очистити кеш та перевстановити
rm -rf node_modules
rm package-lock.json
npm install
```

### Налагодження:

1. Увімкніть Developer Tools: `View -> Toggle Developer Tools`
2. Перевірте логи в консолі
3. Перевірте шлях до бази даних в логах

## Структура даних

SQLite база даних створюється автоматично при першому запуску.

Локація: `%APPDATA%/fantasy-world-builder/` (Windows) або `~/Library/Application Support/fantasy-world-builder/` (macOS)

Файли:
- `worlds.db` - Головна база даних
- `config.json` - Налаштування застосунку

## Міграція з веб версії

Для переносу даних з веб версії:

1. Експортуйте світ з веб версії
2. Відкрийте десктопну версію
3. Використайте `Файл -> Відкрити` для імпорту

## Оновлення

Десктопна версія підтримує автоматичні оновлення (в майбутніх версіях).

Поки що для оновлення потрібно:
1. Завантажити нову версію
2. Встановити поверх старої
3. Дані збережуться автоматично